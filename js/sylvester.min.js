function Vector(){}function Matrix(){}function Line(){}function Plane(){}var Sylvester={version:"0.1.3",precision:1e-6};Vector.prototype={e:function(n){return n<1||n>this.elements.length?null:this.elements[n-1]},dimensions:function(){return this.elements.length},modulus:function(){return Math.sqrt(this.dot(this))},eql:function(n){var t=this.elements.length,i=n.elements||n;if(t!=i.length)return!1;do if(Math.abs(this.elements[t-1]-i[t-1])>Sylvester.precision)return!1;while(--t);return!0},dup:function(){return Vector.create(this.elements)},map:function(n){var t=[];return this.each(function(i,r){t.push(n(i,r))}),Vector.create(t)},each:function(n){var t=this.elements.length,r=t,i;do i=r-t,n(this.elements[i],i+1);while(--t)},toUnitVector:function(){var n=this.modulus();return n===0?this.dup():this.map(function(t){return t/n})},angleFrom:function(n){var u=n.elements||n,f=this.elements.length,o=f,t;if(f!=u.length)return null;var e=0,i=0,r=0;return(this.each(function(n,t){e+=n*u[t-1];i+=n*n;r+=u[t-1]*u[t-1]}),i=Math.sqrt(i),r=Math.sqrt(r),i*r==0)?null:(t=e/(i*r),t<-1&&(t=-1),t>1&&(t=1),Math.acos(t))},isParallelTo:function(n){var t=this.angleFrom(n);return t===null?null:t<=Sylvester.precision},isAntiparallelTo:function(n){var t=this.angleFrom(n);return t===null?null:Math.abs(t-Math.PI)<=Sylvester.precision},isPerpendicularTo:function(n){var t=this.dot(n);return t===null?null:Math.abs(t)<=Sylvester.precision},add:function(n){var t=n.elements||n;return this.elements.length!=t.length?null:this.map(function(n,i){return n+t[i-1]})},subtract:function(n){var t=n.elements||n;return this.elements.length!=t.length?null:this.map(function(n,i){return n-t[i-1]})},multiply:function(n){return this.map(function(t){return t*n})},x:function(n){return this.multiply(n)},dot:function(n){var i=n.elements||n,r=0,t=this.elements.length;if(t!=i.length)return null;do r+=this.elements[t-1]*i[t-1];while(--t);return r},cross:function(n){var t=n.elements||n,i;return this.elements.length!=3||t.length!=3?null:(i=this.elements,Vector.create([i[1]*t[2]-i[2]*t[1],i[2]*t[0]-i[0]*t[2],i[0]*t[1]-i[1]*t[0]]))},max:function(){var n=0,t=this.elements.length,r=t,i;do i=r-t,Math.abs(this.elements[i])>Math.abs(n)&&(n=this.elements[i]);while(--t);return n},indexOf:function(n){var t=null,i=this.elements.length,u=i,r;do r=u-i,t===null&&this.elements[r]==n&&(t=r+1);while(--i);return t},toDiagonalMatrix:function(){return Matrix.Diagonal(this.elements)},round:function(){return this.map(function(n){return Math.round(n)})},snapTo:function(n){return this.map(function(t){return Math.abs(t-n)<=Sylvester.precision?n:t})},distanceFrom:function(n){var t,i,r;return n.anchor?n.distanceFrom(this):(t=n.elements||n,t.length!=this.elements.length)?null:(i=0,this.each(function(n,u){r=n-t[u-1];i+=r*r}),Math.sqrt(i))},liesOn:function(n){return n.contains(this)},liesIn:function(n){return n.contains(this)},rotate:function(n,t){var e,i,r,u,o,f;switch(this.elements.length){case 2:return(e=t.elements||t,e.length!=2)?null:(i=Matrix.Rotation(n).elements,r=this.elements[0]-e[0],u=this.elements[1]-e[1],Vector.create([e[0]+i[0][0]*r+i[0][1]*u,e[1]+i[1][0]*r+i[1][1]*u]));case 3:return t.direction?(f=t.pointClosestTo(this).elements,i=Matrix.Rotation(n,t.direction).elements,r=this.elements[0]-f[0],u=this.elements[1]-f[1],o=this.elements[2]-f[2],Vector.create([f[0]+i[0][0]*r+i[0][1]*u+i[0][2]*o,f[1]+i[1][0]*r+i[1][1]*u+i[1][2]*o,f[2]+i[2][0]*r+i[2][1]*u+i[2][2]*o])):null;default:return null}},reflectionIn:function(n){var i,t,r;return n.anchor?(i=this.elements.slice(),t=n.pointClosestTo(i).elements,Vector.create([t[0]+(t[0]-i[0]),t[1]+(t[1]-i[1]),t[2]+(t[2]-(i[2]||0))])):(r=n.elements||n,this.elements.length!=r.length)?null:this.map(function(n,t){return r[t-1]+(r[t-1]-n)})},to3D:function(){var n=this.dup();switch(n.elements.length){case 3:break;case 2:n.elements.push(0);break;default:return null}return n},inspect:function(){return"["+this.elements.join(", ")+"]"},setElements:function(n){return this.elements=(n.elements||n).slice(),this}};Vector.create=function(n){var t=new Vector;return t.setElements(n)};Vector.i=Vector.create([1,0,0]);Vector.j=Vector.create([0,1,0]);Vector.k=Vector.create([0,0,1]);Vector.Random=function(n){var t=[];do t.push(Math.random());while(--n);return Vector.create(t)};Vector.Zero=function(n){var t=[];do t.push(0);while(--n);return Vector.create(t)};Matrix.prototype={e:function(n,t){return n<1||n>this.elements.length||t<1||t>this.elements[0].length?null:this.elements[n-1][t-1]},row:function(n){return n>this.elements.length?null:Vector.create(this.elements[n-1])},col:function(n){if(n>this.elements[0].length)return null;var i=[],t=this.elements.length,u=t,r;do r=u-t,i.push(this.elements[r][n-1]);while(--t);return Vector.create(i)},dimensions:function(){return{rows:this.elements.length,cols:this.elements[0].length}},rows:function(){return this.elements.length},cols:function(){return this.elements[0].length},eql:function(n){var t=n.elements||n;if(typeof t[0][0]=="undefined"&&(t=Matrix.create(t).elements),this.elements.length!=t.length||this.elements[0].length!=t[0].length)return!1;var i=this.elements.length,o=i,r,u,e=this.elements[0].length,f;do{r=o-i;u=e;do if(f=e-u,Math.abs(this.elements[r][f]-t[r][f])>Sylvester.precision)return!1;while(--u)}while(--i);return!0},dup:function(){return Matrix.create(this.elements)},map:function(n){var r=[],u=this.elements.length,o=u,t,f,e=this.elements[0].length,i;do{t=o-u;f=e;r[t]=[];do i=e-f,r[t][i]=n(this.elements[t][i],t+1,i+1);while(--f)}while(--u);return Matrix.create(r)},isSameSizeAs:function(n){var t=n.elements||n;return typeof t[0][0]=="undefined"&&(t=Matrix.create(t).elements),this.elements.length==t.length&&this.elements[0].length==t[0].length},add:function(n){var t=n.elements||n;return(typeof t[0][0]=="undefined"&&(t=Matrix.create(t).elements),!this.isSameSizeAs(t))?null:this.map(function(n,i,r){return n+t[i-1][r-1]})},subtract:function(n){var t=n.elements||n;return(typeof t[0][0]=="undefined"&&(t=Matrix.create(t).elements),!this.isSameSizeAs(t))?null:this.map(function(n,i,r){return n-t[i-1][r-1]})},canMultiplyFromLeft:function(n){var t=n.elements||n;return typeof t[0][0]=="undefined"&&(t=Matrix.create(t).elements),this.elements[0].length==t.length},multiply:function(n){var c,t;if(!n.elements)return this.map(function(t){return t*n});if(c=n.modulus?!0:!1,t=n.elements||n,typeof t[0][0]=="undefined"&&(t=Matrix.create(t).elements),!this.canMultiplyFromLeft(t))return null;var r=this.elements.length,v=r,i,u,l=t[0].length,f,a=this.elements[0].length,e=[],o,s,h;do{i=v-r;e[i]=[];u=l;do{f=l-u;o=0;s=a;do h=a-s,o+=this.elements[i][h]*t[h][f];while(--s);e[i][f]=o}while(--u)}while(--r);return t=Matrix.create(e),c?t.col(1):t},x:function(n){return this.multiply(n)},minor:function(n,t,i,r){var f=[],s=i,u,e,o,h=this.elements.length,c=this.elements[0].length;do{u=i-s;f[u]=[];e=r;do o=r-e,f[u][o]=this.elements[(n+u-1)%h][(t+o-1)%c];while(--e)}while(--s);return Matrix.create(f)},transpose:function(){var u=this.elements.length,f=this.elements[0].length,t=[],e=f,n,i,r;do{n=f-e;t[n]=[];i=u;do r=u-i,t[n][r]=this.elements[r][n];while(--i)}while(--e);return Matrix.create(t)},isSquare:function(){return this.elements.length==this.elements[0].length},max:function(){var n=0,t=this.elements.length,e=t,i,r,f=this.elements[0].length,u;do{i=e-t;r=f;do u=f-r,Math.abs(this.elements[i][u])>Math.abs(n)&&(n=this.elements[i][u]);while(--r)}while(--t);return n},indexOf:function(n){var t=this.elements.length,e=t,i,r,f=this.elements[0].length,u;do{i=e-t;r=f;do if(u=f-r,this.elements[i][u]==n)return{i:i+1,j:u+1};while(--r)}while(--t);return null},diagonal:function(){if(!this.isSquare)return null;var i=[],n=this.elements.length,r=n,t;do t=r-n,i.push(this.elements[t][t]);while(--n);return Vector.create(i)},toRightTriangular:function(){var t=this.dup(),r,e=this.elements.length,o=e,n,u,f=this.elements[0].length,i,s;do{if(n=o-e,t.elements[n][n]==0)for(j=n+1;j<o;j++)if(t.elements[j][n]!=0){r=[];u=f;do i=f-u,r.push(t.elements[n][i]+t.elements[j][i]);while(--u);t.elements[n]=r;break}if(t.elements[n][n]!=0)for(j=n+1;j<o;j++){s=t.elements[j][n]/t.elements[n][n];r=[];u=f;do i=f-u,r.push(i<=n?0:t.elements[j][i]-t.elements[n][i]*s);while(--u);t.elements[j]=r}}while(--e);return t},toUpperTriangular:function(){return this.toRightTriangular()},determinant:function(){if(!this.isSquare())return null;var n=this.toRightTriangular(),t=n.elements[0][0],i=n.elements.length-1,u=i,r;do r=u-i+1,t=t*n.elements[r][r];while(--i);return t},det:function(){return this.determinant()},isSingular:function(){return this.isSquare()&&this.determinant()===0},trace:function(){if(!this.isSquare())return null;var i=this.elements[0][0],n=this.elements.length-1,r=n,t;do t=r-n+1,i+=this.elements[t][t];while(--n);return i},tr:function(){return this.trace()},rank:function(){var e=this.toRightTriangular(),i=0,n=this.elements.length,o=n,r,t,u=this.elements[0].length,f;do{r=o-n;t=u;do if(f=u-t,Math.abs(e.elements[r][f])>Sylvester.precision){i++;break}while(--t)}while(--n);return i},rk:function(){return this.rank()},augment:function(n){var t=n.elements||n;typeof t[0][0]=="undefined"&&(t=Matrix.create(t).elements);var i=this.dup(),s=i.elements[0].length,r=i.elements.length,h=r,u,f,o=t[0].length,e;if(r!=t.length)return null;do{u=h-r;f=o;do e=o-f,i.elements[u][s+e]=t[u][e];while(--f)}while(--r);return i},inverse:function(){if(!this.isSquare()||this.isSingular())return null;var e=this.elements.length,l=e,n,i,t=this.augment(Matrix.I(e)).toRightTriangular(),r,o=t.elements[0].length,u,f,c,s=[],h;do{n=e-1;f=[];r=o;s[n]=[];c=t.elements[n][n];do u=o-r,h=t.elements[n][u]/c,f.push(h),u>=l&&s[n].push(h);while(--r);for(t.elements[n]=f,i=0;i<n;i++){f=[];r=o;do u=o-r,f.push(t.elements[i][u]-t.elements[n][u]*t.elements[i][n]);while(--r);t.elements[i]=f}}while(--e);return Matrix.create(s)},inv:function(){return this.inverse()},round:function(){return this.map(function(n){return Math.round(n)})},snapTo:function(n){return this.map(function(t){return Math.abs(t-n)<=Sylvester.precision?n:t})},inspect:function(){var t=[],n=this.elements.length,r=n,i;do i=r-n,t.push(Vector.create(this.elements[i]).inspect());while(--n);return t.join("\n")},setElements:function(n){var t,i=n.elements||n,r,o,u,s,e,f,h;if(typeof i[0][0]!="undefined"){r=i.length;o=r;this.elements=[];do{t=o-r;u=i[t].length;s=u;this.elements[t]=[];do e=s-u,this.elements[t][e]=i[t][e];while(--u)}while(--r);return this}f=i.length;h=f;this.elements=[];do t=h-f,this.elements.push([i[t]]);while(--f);return this}};Matrix.create=function(n){var t=new Matrix;return t.setElements(n)};Matrix.I=function(n){var i=[],r=n,t,u,f;do{t=r-n;i[t]=[];u=r;do f=r-u,i[t][f]=t==f?1:0;while(--u)}while(--n);return Matrix.create(i)};Matrix.Diagonal=function(n){var t=n.length,u=t,i,r=Matrix.I(t);do i=u-t,r.elements[i][i]=n[i];while(--t);return r};Matrix.Rotation=function(n,t){var e;if(!t)return Matrix.create([[Math.cos(n),-Math.sin(n)],[Math.sin(n),Math.cos(n)]]);if(e=t.dup(),e.elements.length!=3)return null;var h=e.modulus(),r=e.elements[0]/h,u=e.elements[1]/h,f=e.elements[2]/h,o=Math.sin(n),s=Math.cos(n),i=1-s;return Matrix.create([[i*r*r+s,i*r*u-o*f,i*r*f+o*u],[i*r*u+o*f,i*u*u+s,i*u*f-o*r],[i*r*f-o*u,i*u*f+o*r,i*f*f+s]])};Matrix.RotationX=function(n){var t=Math.cos(n),i=Math.sin(n);return Matrix.create([[1,0,0],[0,t,-i],[0,i,t]])};Matrix.RotationY=function(n){var t=Math.cos(n),i=Math.sin(n);return Matrix.create([[t,0,i],[0,1,0],[-i,0,t]])};Matrix.RotationZ=function(n){var t=Math.cos(n),i=Math.sin(n);return Matrix.create([[t,-i,0],[i,t,0],[0,0,1]])};Matrix.Random=function(n,t){return Matrix.Zero(n,t).map(function(){return Math.random()})};Matrix.Zero=function(n,t){var i=[],f=n,r,u,e;do{r=n-f;i[r]=[];u=t;do e=t-u,i[r][e]=0;while(--u)}while(--f);return Matrix.create(i)};Line.prototype={eql:function(n){return this.isParallelTo(n)&&this.contains(n.anchor)},dup:function(){return Line.create(this.anchor,this.direction)},translate:function(n){var t=n.elements||n;return Line.create([this.anchor.elements[0]+t[0],this.anchor.elements[1]+t[1],this.anchor.elements[2]+(t[2]||0)],this.direction)},isParallelTo:function(n){if(n.normal)return n.isParallelTo(this);var t=this.direction.angleFrom(n.direction);return Math.abs(t)<=Sylvester.precision||Math.abs(t-Math.PI)<=Sylvester.precision},distanceFrom:function(n){var c,l;if(n.normal)return n.distanceFrom(this);if(n.direction){if(this.isParallelTo(n))return this.distanceFrom(n.anchor);var i=this.direction.cross(n.direction).toUnitVector().elements,t=this.anchor.elements,r=n.anchor.elements;return Math.abs((t[0]-r[0])*i[0]+(t[1]-r[1])*i[1]+(t[2]-r[2])*i[2])}var u=n.elements||n,t=this.anchor.elements,f=this.direction.elements,e=u[0]-t[0],o=u[1]-t[1],s=(u[2]||0)-t[2],h=Math.sqrt(e*e+o*o+s*s);return h===0?0:(c=(e*f[0]+o*f[1]+s*f[2])/h,l=1-c*c,Math.abs(h*Math.sqrt(l<0?0:l)))},contains:function(n){var t=this.distanceFrom(n);return t!==null&&t<=Sylvester.precision},liesIn:function(n){return n.contains(this)},intersects:function(n){return n.normal?n.intersects(this):!this.isParallelTo(n)&&this.distanceFrom(n)<=Sylvester.precision},intersectionWith:function(n){if(n.normal)return n.intersectionWith(this);if(!this.intersects(n))return null;var t=this.anchor.elements,s=this.direction.elements,h=n.anchor.elements,c=n.direction.elements,i=s[0],r=s[1],u=s[2],f=c[0],e=c[1],o=c[2],v=t[0]-h[0],y=t[1]-h[1],p=t[2]-h[2],b=-i*v-r*y-u*p,k=f*v+e*y+o*p,d=i*i+r*r+u*u,w=f*f+e*e+o*o,l=i*f+r*e+u*o,a=(b*w/d+l*k)/(w-l*l);return Vector.create([t[0]+a*i,t[1]+a*r,t[2]+a*u])},pointClosestTo:function(n){var t;if(n.direction){if(this.intersects(n))return this.intersectionWith(n);if(this.isParallelTo(n))return null;var i=this.direction.elements,v=n.direction.elements,r=i[0],u=i[1],f=i[2],e=v[0],o=v[1],s=v[2],h=f*e-r*s,c=r*o-u*e,l=u*s-f*o,d=Vector.create([h*s-c*o,c*e-l*s,l*o-h*e]),t=Plane.create(n.anchor,d);return t.intersectionWith(this)}if(t=n.elements||n,this.contains(t))return Vector.create(t);var y=this.anchor.elements,i=this.direction.elements,r=i[0],u=i[1],f=i[2],w=y[0],b=y[1],k=y[2],h=r*(t[1]-b)-u*(t[0]-w),c=u*((t[2]||0)-k)-f*(t[1]-b),l=f*(t[0]-w)-r*((t[2]||0)-k),a=Vector.create([u*h-f*l,f*c-r*h,r*l-u*c]),p=this.distanceFrom(t)/a.modulus();return Vector.create([t[0]+a.elements[0]*p,t[1]+a.elements[1]*p,(t[2]||0)+a.elements[2]*p])},rotate:function(n,t){typeof t.direction=="undefined"&&(t=Line.create(t.to3D(),Vector.k));var i=Matrix.Rotation(n,t.direction).elements,u=t.pointClosestTo(this.anchor).elements,f=this.anchor.elements,r=this.direction.elements,h=u[0],c=u[1],l=u[2],a=f[0],v=f[1],y=f[2],e=a-h,o=v-c,s=y-l;return Line.create([h+i[0][0]*e+i[0][1]*o+i[0][2]*s,c+i[1][0]*e+i[1][1]*o+i[1][2]*s,l+i[2][0]*e+i[2][1]*o+i[2][2]*s],[i[0][0]*r[0]+i[0][1]*r[1]+i[0][2]*r[2],i[1][0]*r[0]+i[1][1]*r[1]+i[1][2]*r[2],i[2][0]*r[0]+i[2][1]*r[1]+i[2][2]*r[2]])},reflectionIn:function(n){var r;if(n.normal){var u=this.anchor.elements,f=this.direction.elements,h=u[0],c=u[1],l=u[2],a=f[0],v=f[1],y=f[2],i=this.anchor.reflectionIn(n).elements,e=h+a,o=c+v,s=l+y,t=n.pointClosestTo([e,o,s]).elements,p=[t[0]+(t[0]-e)-i[0],t[1]+(t[1]-o)-i[1],t[2]+(t[2]-s)-i[2]];return Line.create(i,p)}return n.direction?this.rotate(Math.PI,n):(r=n.elements||n,Line.create(this.anchor.reflectionIn([r[0],r[1],r[2]||0]),this.direction))},setVectors:function(n,t){if(n=Vector.create(n),t=Vector.create(t),n.elements.length==2&&n.elements.push(0),t.elements.length==2&&t.elements.push(0),n.elements.length>3||t.elements.length>3)return null;var i=t.modulus();return i===0?null:(this.anchor=n,this.direction=Vector.create([t.elements[0]/i,t.elements[1]/i,t.elements[2]/i]),this)}};Line.create=function(n,t){var i=new Line;return i.setVectors(n,t)};Line.X=Line.create(Vector.Zero(3),Vector.i);Line.Y=Line.create(Vector.Zero(3),Vector.j);Line.Z=Line.create(Vector.Zero(3),Vector.k);Plane.prototype={eql:function(n){return this.contains(n.anchor)&&this.isParallelTo(n)},dup:function(){return Plane.create(this.anchor,this.normal)},translate:function(n){var t=n.elements||n;return Plane.create([this.anchor.elements[0]+t[0],this.anchor.elements[1]+t[1],this.anchor.elements[2]+(t[2]||0)],this.normal)},isParallelTo:function(n){var t;return n.normal?(t=this.normal.angleFrom(n.normal),Math.abs(t)<=Sylvester.precision||Math.abs(Math.PI-t)<=Sylvester.precision):n.direction?this.normal.isPerpendicularTo(n.direction):null},isPerpendicularTo:function(n){var t=this.normal.angleFrom(n.normal);return Math.abs(Math.PI/2-t)<=Sylvester.precision},distanceFrom:function(n){if(this.intersects(n)||this.contains(n))return 0;if(n.anchor){var t=this.anchor.elements,r=n.anchor.elements,i=this.normal.elements;return Math.abs((t[0]-r[0])*i[0]+(t[1]-r[1])*i[1]+(t[2]-r[2])*i[2])}var u=n.elements||n,t=this.anchor.elements,i=this.normal.elements;return Math.abs((t[0]-u[0])*i[0]+(t[1]-u[1])*i[1]+(t[2]-(u[2]||0))*i[2])},contains:function(n){if(n.normal)return null;if(n.direction)return this.contains(n.anchor)&&this.contains(n.anchor.add(n.direction));var t=n.elements||n,i=this.anchor.elements,r=this.normal.elements,u=Math.abs(r[0]*(i[0]-t[0])+r[1]*(i[1]-t[1])+r[2]*(i[2]-(t[2]||0)));return u<=Sylvester.precision},intersects:function(n){return typeof n.direction=="undefined"&&typeof n.normal=="undefined"?null:!this.isParallelTo(n)},intersectionWith:function(n){var e;if(!this.intersects(n))return null;if(n.direction){var i=n.anchor.elements,u=n.direction.elements,s=this.anchor.elements,t=this.normal.elements,h=(t[0]*(s[0]-i[0])+t[1]*(s[1]-i[1])+t[2]*(s[2]-i[2]))/(t[0]*u[0]+t[1]*u[1]+t[2]*u[2]);return Vector.create([i[0]+u[0]*h,i[1]+u[1]*h,i[2]+u[2]*h])}if(n.normal){for(var p=this.normal.cross(n.normal).toUnitVector(),t=this.normal.elements,i=this.anchor.elements,f=n.normal.elements,c=n.anchor.elements,l=Matrix.Zero(2,2),r=0;l.isSingular();)r++,l=Matrix.create([[t[r%3],t[(r+1)%3]],[f[r%3],f[(r+1)%3]]]);var o=l.inverse().elements,a=t[0]*i[0]+t[1]*i[1]+t[2]*i[2],v=f[0]*c[0]+f[1]*c[1]+f[2]*c[2],w=[o[0][0]*a+o[0][1]*v,o[1][0]*a+o[1][1]*v],y=[];for(e=1;e<=3;e++)y.push(r==e?0:w[(e+(5-r)%3)%3]);return Line.create(y,p)}},pointClosestTo:function(n){var t=n.elements||n,r=this.anchor.elements,i=this.normal.elements,u=(r[0]-t[0])*i[0]+(r[1]-t[1])*i[1]+(r[2]-(t[2]||0))*i[2];return Vector.create([t[0]+i[0]*u,t[1]+i[1]*u,(t[2]||0)+i[2]*u])},rotate:function(n,t){var i=Matrix.Rotation(n,t.direction).elements,u=t.pointClosestTo(this.anchor).elements,f=this.anchor.elements,r=this.normal.elements,h=u[0],c=u[1],l=u[2],a=f[0],v=f[1],y=f[2],e=a-h,o=v-c,s=y-l;return Plane.create([h+i[0][0]*e+i[0][1]*o+i[0][2]*s,c+i[1][0]*e+i[1][1]*o+i[1][2]*s,l+i[2][0]*e+i[2][1]*o+i[2][2]*s],[i[0][0]*r[0]+i[0][1]*r[1]+i[0][2]*r[2],i[1][0]*r[0]+i[1][1]*r[1]+i[1][2]*r[2],i[2][0]*r[0]+i[2][1]*r[1]+i[2][2]*r[2]])},reflectionIn:function(n){var r;if(n.normal){var u=this.anchor.elements,f=this.normal.elements,h=u[0],c=u[1],l=u[2],a=f[0],v=f[1],y=f[2],i=this.anchor.reflectionIn(n).elements,e=h+a,o=c+v,s=l+y,t=n.pointClosestTo([e,o,s]).elements,p=[t[0]+(t[0]-e)-i[0],t[1]+(t[1]-o)-i[1],t[2]+(t[2]-s)-i[2]];return Plane.create(i,p)}return n.direction?this.rotate(Math.PI,n):(r=n.elements||n,Plane.create(this.anchor.reflectionIn([r[0],r[1],r[2]||0]),this.normal))},setVectors:function(n,t,i){if((n=Vector.create(n),n=n.to3D(),n===null)||(t=Vector.create(t),t=t.to3D(),t===null))return null;if(typeof i=="undefined")i=null;else if(i=Vector.create(i),i=i.to3D(),i===null)return null;var f=n.elements[0],e=n.elements[1],o=n.elements[2],s=t.elements[0],h=t.elements[1],c=t.elements[2],u,r;if(i!==null){var l=i.elements[0],a=i.elements[1],v=i.elements[2];if(u=Vector.create([(h-e)*(v-o)-(c-o)*(a-e),(c-o)*(l-f)-(s-f)*(v-o),(s-f)*(a-e)-(h-e)*(l-f)]),r=u.modulus(),r===0)return null;u=Vector.create([u.elements[0]/r,u.elements[1]/r,u.elements[2]/r])}else{if(r=Math.sqrt(s*s+h*h+c*c),r===0)return null;u=Vector.create([t.elements[0]/r,t.elements[1]/r,t.elements[2]/r])}return this.anchor=n,this.normal=u,this}};Plane.create=function(n,t,i){var r=new Plane;return r.setVectors(n,t,i)};Plane.XY=Plane.create(Vector.Zero(3),Vector.k);Plane.YZ=Plane.create(Vector.Zero(3),Vector.i);Plane.ZX=Plane.create(Vector.Zero(3),Vector.j);Plane.YX=Plane.XY;Plane.ZY=Plane.YZ;Plane.XZ=Plane.ZX;var $V=Vector.create,$M=Matrix.create,$L=Line.create,$P=Plane.create;
//# sourceMappingURL=sylvester.min.js.map
